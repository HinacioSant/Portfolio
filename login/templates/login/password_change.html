{% extends 'PTs/layout.html' %}

{% block content %}

<form action="/password_change" name="ChangeForm" method="post" class="row g-3 needs-validation" novalidate >
  {% csrf_token %}
  <div class="col-md-3">
    <label for="old_password" class="form-label">Old Password</label>
    <input type="password" class="form-control {{old_password_validation}}" aria-describedby="oldpassHelp" placeholder="Old Password" id="old_password" name="old_password" required>
    <div id="oldpassHelp" class="form-text">Your old password</div>
    <div class="invalid-feedback">
      {% if old_password_validation %}
          Wrong password.
      {% else %}
          Please choose a valid password.
      {% endif %}
    </div>
  </div>
  <div class="col-md-3">
    <label for="new_password1" class="form-label">New Password</label>
    <input type="password" class="form-control" aria-describedby="newpass1Help" placeholder="New Password"  id="new_password1" name="new_password1" required>
    <div id="newpass1Help" class="form-text">Passwords must have more than 6 characteres and less than 64!</div>
    <div id="newpass1Help" class="form-text">Passwords must have at least a letter and a number </div>
    <div class="invalid-feedback">
        Please choose a valid password.
    </div>
  </div>
  <div class="col-md-3">
    <label for="new_password2" class="form-label">New Password Verification</label>
    <input type="password" class="form-control {{new_password_validation}}" aria-describedby="newpass2Help" placeholder="New Password verification" id="new_password2" name="new_password2" required>
    <div id="newpass2Help" class="form-text">Passwords must match!</div>
    <div class="invalid-feedback">
      {% if m %}
          Password don't match.
      {% elif s %}
          Password too short.
      {% elif l %}
          Password too long
      {% else %}
          Please choose a valid password.
      {% endif %}
    </div>
    <input type="checkbox" class="form-check-input" id="s_pass">
    <label class="form-check-label" for="exampleCheck1">Show Password</label>
    <div class="col-12">
      <button class="btn btn-primary" type="submit">Submit form</button>
    </div>
</form>

<script>
  // Example starter JavaScript for disabling form submissions if there are invalid fields
(function () {
  'use strict'

  // Fetch all the forms we want to apply custom Bootstrap validation styles to
  var forms = document.querySelectorAll('.needs-validation')

  // Loop over them and prevent submission
  Array.prototype.slice.call(forms)
    .forEach(function (form) {
      form.addEventListener('submit', function (event) {

        if (!form.checkValidity()) {
          event.preventDefault()
          event.stopPropagation()
        };

        form.classList.add('was-validated')
      }, false)
    })
})()

document.addEventListener('DOMContentLoaded',() => {

    document.querySelector('#s_pass').onclick = () => {
      if (document.querySelector('#new_password1').type === "password") {
          document.querySelector('#new_password1').type = Text
          document.querySelector('#new_password2').type = Text
          document.querySelector('#old_password').type = Text
        }
      else {
          document.querySelector('#new_password1').type = "password"
          document.querySelector('#new_password2').type = "password"
          document.querySelector('#old_password').type = "password"
      }
    };
  });

</script>
{% endblock %}
